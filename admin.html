<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Space Management Tool - Admin Panel</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link rel="stylesheet" href="admin-styles.css" />
</head>
<body>
    <div class="admin-container">
        <!-- Header -->
        <header class="admin-header">
            <h1><i class="fas fa-tools"></i> Project Space Management Tool - Admin Panel</h1>
            <div class="admin-nav">
                <button class="nav-btn active" data-tab="dashboard">
                    <i class="fas fa-chart-line"></i> Dashboard
                </button>
                <button class="nav-btn" data-tab="projects">
                    <i class="fas fa-project-diagram"></i> Projects
                </button>
                <button class="nav-btn" data-tab="spaces">
                    <i class="fas fa-map-marker-alt"></i> Spaces
                </button>
                <button class="nav-btn" data-tab="categories">
                    <i class="fas fa-tags"></i> Categories
                </button>
                <button class="nav-btn" data-tab="companies">
                    <i class="fas fa-building"></i> Companies
                </button>
                <button class="nav-btn" data-tab="activity">
                    <i class="fas fa-history"></i> Activity Log
                </button>
                <button class="nav-btn" data-tab="settings">
                    <i class="fas fa-cog"></i> Settings
                </button>
                <button class="nav-btn" onclick="window.location.href='logistics-map.html'">
                    <i class="fas fa-map"></i> Logistics Map
                </button>
                <button class="nav-btn" onclick="window.location.href='index.html'">
                    <i class="fas fa-arrow-left"></i> Back to Tool
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="admin-content">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <h2>Dashboard Overview</h2>
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <h3>Total Projects</h3>
                        <p id="totalProjects">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Active Projects</h3>
                        <p id="activeProjects">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total Spaces</h3>
                        <p id="totalSpaces">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total Phases</h3>
                        <p id="totalPhases">0</p>
                    </div>
                </div>
                <div class="chart-container">
                    <h3>Recent Activity</h3>
                    <div id="recentActivity">
                        <!-- Recent activity will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Projects Tab -->
            <div id="projects" class="tab-content">
                <div class="tab-header">
                    <h2>Project Management</h2>
                    <button class="btn btn-primary" id="addProjectBtn">
                        <i class="fas fa-plus"></i> Add Project
                    </button>
                </div>
                <div class="table-container">
                    <table id="projectsTable" class="admin-table">
                        <thead>
                            <tr>
                                <th>Project Name</th>
                                <th>Coordinates</th>
                                <th>Zoom Level</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Projects will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>


            <!-- Spaces Tab -->
            <div id="spaces" class="tab-content">
                <div class="tab-header">
                    <h2>Space Management</h2>
                    <button class="btn btn-primary" id="addSpaceBtn" disabled>
                        <i class="fas fa-plus"></i> Add Space
                    </button>
                </div>
                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    <span>Select a project first to manage its spaces</span>
                </div>
                <div class="table-container">
                    <table id="spacesTable" class="admin-table">
                        <thead>
                            <tr>
                                <th>Space Name</th>
                                <th>Project</th>
                                <th>Category</th>
                                <th>Trade</th>
                                <th>Description</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Spaces will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Categories Tab -->
            <div id="categories" class="tab-content">
                <div class="tab-header">
                    <h2>Space Categories Management</h2>
                    <button class="btn btn-primary" id="addCategoryBtn">
                        <i class="fas fa-plus"></i> Add Category
                    </button>
                </div>
                <div class="table-container">
                    <table id="categoriesTable" class="admin-table">
                        <thead>
                            <tr>
                                <th>Category Name</th>
                                <th>Description</th>
                                <th>Usage Count</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Categories will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Companies Tab -->
            <div id="companies" class="tab-content">
                <div class="tab-header">
                    <h2>Companies/Contractors Management</h2>
                    <button class="btn btn-primary" id="addCompanyBtn">
                        <i class="fas fa-plus"></i> Add Company
                    </button>
                </div>
                <div class="table-container">
                    <table id="companiesTable" class="admin-table">
                        <thead>
                            <tr>
                                <th>Company Name</th>
                                <th>Contact Info</th>
                                <th>Usage Count</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Companies will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>


            <!-- Activity Log Tab -->
            <div id="activity" class="tab-content">
                <div class="tab-header">
                    <h2>Activity Log</h2>
                    <button class="btn btn-secondary" onclick="adminPanel.clearActivityLog()">
                        <i class="fas fa-trash"></i> Clear Log
                    </button>
                </div>
                <div class="table-container">
                    <table id="activityTable" class="admin-table">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>User</th>
                                <th>Action</th>
                                <th>Details</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Activity will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings" class="tab-content">
                <h2>Settings</h2>
                <div class="settings-grid">
                    <div class="setting-card">
                        <h3>Database Settings</h3>
                        <p>Database connection status and configuration</p>
                        <div class="setting-status">
                            <span class="status-indicator" id="dbStatus">Connected</span>
                        </div>
                    </div>
                    <div class="setting-card">
                        <h3>Export Settings</h3>
                        <p>Configure data export options</p>
                        <button class="btn btn-secondary">Configure</button>
                    </div>
                    <div class="setting-card">
                        <h3>Backup Settings</h3>
                        <p>Manage data backup and restore</p>
                        <button class="btn btn-secondary">Backup Now</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals will be added here -->
    <div id="modalContainer"></div>

    <!-- Global Error Banner -->
    <div id="globalErrorBanner" class="global-error-banner">
        <div class="banner-content">
            <span id="globalErrorText">An unexpected error occurred.</span>
            <div class="banner-actions">
                <button id="globalErrorRetry" class="btn btn-secondary">Retry</button>
                <button id="globalErrorDismiss" class="btn btn-secondary">Dismiss</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="src/core/config.js"></script>
    <script src="src/core/supabase-client.js"></script>
    <script src="https://unpkg.com/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="admin-script.js"></script>
</body>
</html>
